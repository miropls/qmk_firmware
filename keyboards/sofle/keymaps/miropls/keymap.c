// clang-format off

#include QMK_KEYBOARD_H
#include "keymap_finnish.h"

#define _COLEMAK 0
#define _QWERTY 1
#define _GAMING 2
#define _NAV 3
#define _MOUSE 4

enum custom_keycodes {
    FI_COLEMAK = SAFE_RANGE,
    FI_QWERTY,
};

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

[_MOUSE] = LAYOUT(
  _______,   _______,   _______,    _______,    _______,    _______,                    _______,    _______,    _______,    _______,    _______,  _______,
  _______,   _______,   _______,    _______,    _______,    _______,                    _______,    _______,    _______,    _______,    _______,  _______,
  _______,   _______,   _______,    _______,    _______,    _______,                    KC_MS_L,    KC_MS_D,    KC_MS_U,    KC_MS_R,    _______,  _______,
  _______,  _______,   _______,    _______,    _______,    _______, _______,    _______, _______,    _______, _______,  _______, _______,  _______,
                                _______, _______, _______, _______, _______,    KC_MS_BTN2, KC_MS_BTN1, KC_MS_BTN3, _______, _______
),

[_NAV] = LAYOUT(
  _______,   _______,   _______,    _______,    _______,    _______,                    _______,    KC_END,     KC_HOME,    _______,    _______,  _______,
  _______,   _______,   _______,   _______,    _______,    _______,                    _______,    KC_PGDN,    KC_PGUP,    _______,    _______,  _______,
  _______,   KC_LGUI,   KC_LALT,    KC_LCTL,    KC_LSFT,    _______,                    KC_LEFT,    KC_DOWN,    KC_UP,    KC_RIGHT,    _______,  _______,
  _______,  _______,   _______,    _______,    _______,    _______, _______,    _______, _______,    KC_MPLY, _______,  _______, _______,  _______,
                                _______, _______, _______, _______, _______,    _______, _______, _______, _______, _______
),

// QWERTY moved one step to left for more ergonomics
[_GAMING] = LAYOUT(
  KC_ESC,   FI_1,   FI_2,    FI_3,    FI_4,    FI_5,                     FI_6,    FI_7,    FI_8,    FI_9,    FI_0,  TG(_QWERTY),
  _______,   KC_TAB,   FI_Q,    FI_W,    FI_E,    FI_R,                     FI_Y,    FI_U,    FI_I,    FI_O,    FI_P,  _______,
  _______,   KC_LSFT,   FI_A,    FI_S,    FI_D,    FI_F,                     FI_H,    FI_J,    FI_K,    FI_L, _______,  _______,
  _______,  KC_LCTL,   FI_Z,    FI_X,    FI_C,    FI_V, KC_MPLY,     XXXXXXX,FI_N,    FI_M, FI_COMM,  FI_DOT, _______,  TG(_GAMING),
                 KC_LGUI,_______, KC_LALT, KC_SPC, _______,      _______,  KC_ENT, _______, _______, _______
),

/*
 * QWERTY
 * ,-----------------------------------------.                    ,-----------------------------------------.
 * |  `   |   1  |   2  |   3  |   4  |   5  |                    |   6  |   7  |   8  |   9  |   0  |  `   |
 * |------+------+------+------+------+------|                    |------+------+------+------+------+------|
 * | ESC  |   Q  |   W  |   E  |   R  |   T  |                    |   Y  |   U  |   I  |   O  |   P  | Bspc |
 * |------+------+------+------+------+------|                    |------+------+------+------+------+------|
 * | Tab  |   A  |   S  |   D  |   F  |   G  |-------.    ,-------|   H  |   J  |   K  |   L  |   ;  |  '   |
 * |------+------+------+------+------+------|  MUTE |    |       |------+------+------+------+------+------|
 * |LShift|   Z  |   X  |   C  |   V  |   B  |-------|    |-------|   N  |   M  |   ,  |   .  |   /  |RShift|
 * `-----------------------------------------/       /     \      \-----------------------------------------'
 *            | LGUI | LAlt | LCTR |LOWER | /Enter  /       \Space \  |RAISE | RCTR | RAlt | RGUI |
 *            |      |      |      |      |/       /         \      \ |      |      |      |      |
 *            `----------------------------------'           '------''---------------------------'
 */

[_QWERTY] = LAYOUT(
  KC_ESC,   FI_1,   FI_2,    FI_3,    FI_4,    FI_5,                     FI_6,    FI_7,    FI_8,    FI_9,    FI_0,  TG(_QWERTY),
  KC_TAB,   FI_Q,   FI_W,    FI_E,    FI_R,    FI_T,                     FI_Y,    FI_U,    FI_I,    FI_O,    FI_P,  KC_BSPC,
  KC_LSFT,   FI_A,   FI_S,    FI_D,    FI_F,    FI_G,                     FI_H,    FI_J,    FI_K,    FI_L, FI_SCLN,  FI_QUOT,
  KC_LCTL,  FI_Z,   FI_X,    FI_C,    FI_V,    FI_B, KC_MPLY,     XXXXXXX,FI_N,    FI_M, FI_COMM,  FI_DOT, FI_SLSH,  KC_RSFT,
                 KC_LGUI,KC_LALT, _______, KC_SPC, _______,      _______,  KC_ENT, _______, KC_RALT, KC_RGUI
),

/*
 * COLEMAK
 * ,-----------------------------------------.                    ,-----------------------------------------.
 * |  `   |   1  |   2  |   3  |   4  |   5  |                    |   6  |   7  |   8  |   9  |   0  |  QWERTY|
 * |------+------+------+------+------+------|                    |------+------+------+------+------+------|
 * | ESC  |   Q  |   W  |   F  |   P  |   G  |                    |   J  |   L  |   U  |   Y  |   Ö  |  Ä   |
 * |------+------+------+------+------+------|                    |------+------+------+------+------+------|
 * | TAB  |   A  |   R  |   S  |   T  |   D  |-------.    ,-------|   H  |   N  |   E  |   I  |   O  |  '   |
 * |------+------+------+------+------+------|  MUTE |    |       |------+------+------+------+------+------|
 * |LShift|   Z  |   X  |   C  |   V  |   B  |-------|    |-------|   K  |   M  |   ,  |   .  |   /  |RShift|
 * `-----------------------------------------/       /     \      \-----------------------------------------'
 *            | LGUI | LAlt | LCTR |LOWER | /Enter  /       \Space \  |RAISE | RCTR | RAlt | RGUI |
 *            |      |      |      |      |/       /         \      \ |      |      |      |      |
 *            `----------------------------------'           '------''---------------------------'
 */

[_COLEMAK] = LAYOUT(
  KC_EQL,   FI_1,   FI_2,    FI_3,    FI_4,    FI_5,                      FI_6,    FI_7,    FI_8,    FI_9,    FI_0,  FI_PLUS,
  KC_LBRC,   FI_Q,   FI_W,    FI_F,    FI_P,    FI_B,                      FI_J,    FI_L,    FI_U,    FI_Y, FI_ODIA,  FI_ADIA,
  KC_RBRC,   LGUI_T(FI_A), LALT_T(FI_R), LCTL_T(FI_S), LSFT_T(FI_T), FI_G,       FI_M,    RSFT_T(FI_N),    RCTL_T(FI_E),    RALT_T(FI_I), FI_O,  FI_QUOT,
  KC_NUBS,  FI_Z,   FI_X,    FI_C,    FI_D,    FI_V, KC_MPLY,      KC_MPLY, FI_K,    FI_H, FI_COMM,  FI_DOT, FI_MINS,  TG(_GAMING),
                 KC_LGUI, KC_LALT, KC_ESC, LT(_NAV, KC_SPC), LT(_MOUSE, KC_TAB),      KC_ENT,  KC_BSPC, KC_DEL,KC_RALT, KC_RGUI
)
};

#ifdef OLED_ENABLE

    static void render_fine_animation(void) {
        static uint32_t key_timer = 0;
        static uint8_t current_frame = 0;

        static const char PROGMEM fine0[] = {
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 64,  0,  0,  0,  0,128,  0,  0,240,140,  0,  0,  0,  0,  0,  0,128,  0,  0,  0, 76,  0,128, 32,  0,  0,  0,  0,  0,128,  0,  0,  3,  4,192,128,  0, 97,247, 28,  7,131,206,124,  0,128,192,240, 24,129,  0, 56,236,128, 17, 32,224, 60,  0,  0,  0,  0,131,254, 52, 28, 15, 63, 48, 32, 63, 24, 16,  0,  3,  4,  3,  1, 15,  9, 62, 99,192,  6, 56, 83, 94,198,  3,  1,  0,
            0,  0,  0,  7, 15, 24, 48, 96,206,136,156,246,226,128,146,132,253,231,160,188,134,224,128,195, 96, 48, 24, 12,  7,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255,255,255,255,191,137,159,142,142,198,197,227,251,123,187,239,255,191,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127, 63, 29, 13,  7,  7,127,205, 61, 21, 22, 63,223,127, 51,253,135,  2,  3,  5,131,255,255,127, 63, 63, 63, 63,
            63,127,193,128,  0,  0,  0,128,192,248,254,251,244,248,248,244,251,254,255,252,238,198, 31,255,191,191,184,184,240,208,224,240,248,252,255,255,255,255, 31,255,255,255,131,255,135,127,255,255,255,255,255,255,255,255,124,115, 31,255,255,255,255,255,255,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  3,255,255,  3,  3,  0,  0,255,255, 24, 24,255,255,  0,  0,  0,  0,255,255,  0,  0,  0,  0,102,207,153,153,243,102, 
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255,  0,  0,  0,  0,102,207,153,153,115,102,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255, 27, 27, 27,  3,  0,  0,  0,  0,255,255,  0,  0,  0,255,255,  3,255,192,255,255,  0,  0,255,255,219,219,219,195, 
            0,
        };

        static const char PROGMEM fine1[] = {
            0,  0,  0,128,  0, 16, 32,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,128,  0,  0,  0, 96,  0,  0,  0,  0,  0,  0,  0,  0,  1,  4,  0,  0,  0,  0,  0,192,128, 12,240,128,  0,  0,  0,128,  5,  0,  1,  0,  0,  0,  0,  8, 64,  0,  0,  0,  0,  0,  0,128,  0,  0,224,128,192,128,  0, 96,247, 28,  7,131,222,118,  3,129,248,200, 12,128,  7, 60,224,128, 16, 38,252, 48,  0,  0,112,216,131,254, 52, 28, 15, 63, 48, 32, 63,  4, 12,  8,  3,  4,  3,  1,143,  9, 62, 99,192,  2,  2, 19, 30,214,115,  1,  0,
            0,  0,  0,  7, 15, 24, 48, 98,206,136,156,244,224,132,128,132,252,231,160,190,134,160,208,131, 96, 48, 24, 12,  7,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255,255,255,255,191,137,159,142,142,198,197,227,251,123,187,239,255,191,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127, 63, 29, 13,  7,  7,127,205, 61, 21, 22, 63,223,127, 51,253,135,  2,  3,  5,131,255,255,127, 63, 63, 63, 63,
            63,127,193,128,  0,  0,  0,128,192,248,254,251,244,248,248,244,251,254,255,252,238,198, 31,255,191,191,184,184,240,208,224,240,248,252,255,255,255,255, 31,255,255,255,131,255,135,127,255,255,255,255,255,255,255,255,124,115, 31,255,255,255,255,255,255,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  3,255,255,  3,  3,  0,  0,255,255, 24, 24,255,255,  0,  0,  0,  0,255,255,  0,  0,  0,  0,102,207,153,153,243,102, 
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255,  0,  0,  0,  0,102,207,153,153,115,102,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255, 27, 27, 27,  3,  0,  0,  0,  0,255,255,  0,  0,  0,255,255,  3,255,192,255,255,  0,  0,255,255,219,219,219,195, 
            0,
        };

        static const char PROGMEM fine2[] = {
            0,  0,  0,  4,  8,  0,  0, 64,  0,  6,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,130, 16, 12,  0,  0,  0,  4, 12,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,192,  0,  0,192,128,240,156,192,  0,  1, 48,  1,  8,  0,  0,  0,  0,  0, 64,  8,128,  0,  0,  0,128,  0,  0,224,128, 64,  0,  0, 96,244, 28,  7,131,222,112, 28,134,251,200, 12,128,  7, 60,224,132,  4,  6,252,  7,  0,  0,112,216,131,254, 55, 28, 14, 62,176, 32, 63,  4, 12,  0,  3,  4,  3,  1, 15,  9, 62, 99, 64,  2,  2, 19, 30,214,115,  1,  0,
            0,  0,  0,  7, 15, 24, 48, 96,200,249,141,143,128,132,135,132,252,128,226,190,132,176,216,140, 96, 48, 24, 12,  7,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255,255,255,255,191,137,159,142,142,198,197,227,251,123,187,239,255,191,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127, 63, 29, 13,  7,  7,127,205, 61, 21, 22, 63,223,127, 51,253,135,  2,  3,  5,131,255,255,127, 63, 63, 63, 63,
            63,127,193,128,  0,  0,  0,128,192,248,254,251,244,248,248,244,251,254,255,252,238,198, 31,255,191,191,184,184,240,208,224,240,248,252,255,255,255,255, 31,255,255,255,131,255,135,127,255,255,255,255,255,255,255,255,124,115, 31,255,255,255,255,255,255,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  3,255,255,  3,  3,  0,  0,255,255, 24, 24,255,255,  0,  0,  0,  0,255,255,  0,  0,  0,  0,102,207,153,153,243,102, 
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255,  0,  0,  0,  0,102,207,153,153,115,102,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255, 27, 27, 27,  3,  0,  0,  0,  0,255,255,  0,  0,  0,255,255,  3,255,192,255,255,  0,  0,255,255,219,219,219,195, 
            0,
        };

        static const char* FRAMES[] = {fine0, fine1, fine2};

        void switch_frame(void) {
            if (current_frame < 3) {
                oled_write_raw_P(FRAMES[current_frame], 512);
                current_frame++;
            } else {
                current_frame = 0;
            }
        }

        if (timer_elapsed32(key_timer) > 100) {
            key_timer = timer_read32();
            switch_frame();
        }
    }

    static void render_coffee_animation(void) {
        static uint32_t key_timer = 0;
        static uint8_t current_frame = 0;

        static const char PROGMEM coffee0[] = {
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,128, 64,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 32,192,  0,128,  0,  1, 49,  0,128, 25, 12,  4,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,128,128,128,129,129,131,176,224,128,128,129,156,160,192,128,128,128,128,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 
            0,  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255, 24, 12, 12, 12, 28, 56,240,224,  0,  0,  0,  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,  0,  0,  0,  0,  0,  0,255,255,  0,  0,  0,  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,  0,  0,  0,  0,  0,128,255,255,  0,  0,  0,  0, 63,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127, 63, 12, 12, 12,  6,  7,  3,  1,  0,  0,  0, 
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        };

        static const char PROGMEM coffee1[] = {
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,192,  0, 17,  8,  1,  0,128,  0,  6,  0,  0,  0,  0,  0,  0,  0,  0,160,  0, 48, 16,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  6,  0,  0,224,  7,  4,  0,  1,128,  1,  0,  0, 24, 12,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,128,128,128,128,128,128,185,234,136,128,129,156,160,192,128,128,128,128,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 
            0,  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255, 24, 12, 12, 12, 28, 56,240,224,  0,  0,  0,  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,  0,  0,  0,  0,  0,  0,255,255,  0,  0,  0,  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,  0,  0,  0,  0,  0,128,255,255,  0,  0,  0,  0, 63,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127, 63, 12, 12, 12,  6,  7,  3,  1,  0,  0,  0, 
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        };

        static const char PROGMEM coffee2[] = {
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 14,  0,  0,  0,  0,  0,  0,  0,192, 32,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,192, 96,  0,  0,  0,  0,  0,  0,  0,  6,225,  0,  0,  0,  0,  0,  0,135,  0,  0,  0,  0,  0,  0,  0,  0,
            0,  0,  0,  0,  0,  0, 16, 15,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,143,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,192, 81,  8,  1,  0,  0,  0, 64,128,  6,  1,  0,  0,  0,  0,  0,160,  0,  0,129, 96,  0,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  3,  0,224,  0,  4,  0,  1,128,  1,  0,  0, 16, 12,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,128,128,128,128,128,128,185,234,136,128,129,156,160,192,128,128,128,128,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 
            0,  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255, 24, 12, 12, 12, 28, 56,240,224,  0,  0,  0,  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,  0,  0,  0,  0,  0,  0,255,255,  0,  0,  0,  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,  0,  0,  0,  0,  0,128,255,255,  0,  0,  0,  0, 63,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127, 63, 12, 12, 12,  6,  7,  3,  1,  0,  0,  0, 
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        };

        static const char PROGMEM coffee3[] = {
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,112, 16,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,112,  0,  4,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,128,  0,  0,  0,  3,  1,  0,  0,224,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,192, 32,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,192,  0,  0,  0,  0, 96,  0,  0,  2,  0, 33,  0,  0,  0,  0,  0,  0,135,  0,  0,  0,  0,  0,  0,  0,  0,
            0,  0,  0,  0,  0,  0, 16,  9,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,143,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,192, 81,  8,  1,  0,  0,128,  0,  0,  6,  1,  0,  0,  4,  0,  0, 56,  0,128,  1, 72,  4,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  3,  0,224,  0,  5,  1,  0,129,  0,  0,  0,  7, 12,192,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,128,128,128,128,128,152,145,202,168,144,129,156,192,128,128,248,177,152,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 
            0,  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255, 24, 12, 12, 12, 28, 56,240,224,  0,  0,  0,  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,  0,  0,  0,  0,  0,  0,255,255,  0,  0,  0,  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,  0,  0,  0,  0,  0,128,255,255,  0,  0,  0,  0, 63,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127, 63, 12, 12, 12,  6,  7,  3,  1,  0,  0,  0, 
            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        };

        static const char* FRAMES[] = {coffee0, coffee1, coffee2, coffee3};

        void switch_frame(void) {
            if (current_frame < 4) {
                oled_write_raw_P(FRAMES[current_frame], 512);
                current_frame++;
            } else {
                current_frame = 0;
            }
        }

        if (timer_elapsed32(key_timer) > 100) {
            key_timer = timer_read32();
            switch_frame();
        }
    }

    oled_rotation_t oled_init_user(oled_rotation_t rotation) {
    if (is_keyboard_master()) {
        return OLED_ROTATION_270;
    } else {
        return OLED_ROTATION_270;
    }
    return rotation;
    }

    bool oled_task_user(void) {
        if (is_keyboard_master()) {
            render_fine_animation();
        } else {
            render_coffee_animation();
        }
        return false;   
    }

#endif


bool process_record_user(uint16_t keycode, keyrecord_t *record) {
    switch (keycode) {
        case FI_COLEMAK:
            if (record->event.pressed) {
                set_single_persistent_default_layer(_COLEMAK);
            }
            return false;
        case FI_QWERTY:
            if (record->event.pressed) {
                set_single_persistent_default_layer(_QWERTY);
            }
            return false;
    }
    return true;
}

#ifdef ENCODER_ENABLE

bool encoder_update_user(uint8_t index, bool clockwise) {
    if (index == 0) {
        if (clockwise) {
            tap_code_delay(KC_VOLU, 20);
        } else {
            tap_code_delay(KC_VOLD, 20);
        }
    } else if (index == 1) {
        if (clockwise) {
            tap_code_delay(KC_MNXT, 20);
        } else {
            tap_code_delay(KC_MPRV, 20);
        }
    }
    return true;
}

#endif
